INFO 04-10 08:23:04 [__init__.py:239] Automatically detected platform cuda.
INFO:lm_eval.__main__:Selected Tasks: ['piqa']
INFO:lm_eval.evaluator:Setting random seed to 0 | Setting numpy seed to 1234 | Setting torch manual seed to 1234 | Setting fewshot manual seed to 1234
INFO:lm_eval.evaluator:Initializing hf model, with arguments: {'pretrained': 'google/gemma-3-4b-it'}
INFO:lm_eval.models.huggingface:Using device 'cuda'
INFO:lm_eval.models.huggingface:Model parallel was set to False, max memory was not set, and device map was set to {'': 'cuda'}
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.47s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.01it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.06s/it]
INFO:lm_eval.models.huggingface:Model type is 'gemma3', part of the Gemma family--a BOS token will be used as Gemma underperforms without it.
WARNING:lm_eval.evaluator:Overwriting default num_fewshot of piqa from None to 0
INFO:lm_eval.api.task:Building contexts for piqa on rank 0...
  0%|          | 0/1838 [00:00<?, ?it/s] 11%|█         | 202/1838 [00:00<00:00, 2011.87it/s] 22%|██▏       | 406/1838 [00:00<00:00, 2023.07it/s] 33%|███▎      | 609/1838 [00:00<00:00, 2006.00it/s] 44%|████▍     | 817/1838 [00:00<00:00, 2031.94it/s] 56%|█████▌    | 1025/1838 [00:00<00:00, 2045.75it/s] 67%|██████▋   | 1234/1838 [00:00<00:00, 2058.42it/s] 78%|███████▊  | 1442/1838 [00:00<00:00, 2064.85it/s] 90%|████████▉ | 1650/1838 [00:00<00:00, 2067.78it/s]100%|██████████| 1838/1838 [00:00<00:00, 2052.85it/s]
INFO:lm_eval.evaluator:Running loglikelihood requests
Running loglikelihood requests:   0%|          | 0/3676 [00:00<?, ?it/s]Running loglikelihood requests:   0%|          | 1/3676 [00:02<2:22:09,  2.32s/it]Running loglikelihood requests:   4%|▎         | 129/3676 [00:02<01:01, 57.69it/s]Running loglikelihood requests:   7%|▋         | 257/3676 [00:03<00:31, 108.21it/s]Running loglikelihood requests:  11%|█         | 386/3676 [00:03<00:20, 157.63it/s]Running loglikelihood requests:  14%|█▍        | 514/3676 [00:04<00:15, 205.97it/s]Running loglikelihood requests:  17%|█▋        | 642/3676 [00:04<00:11, 254.11it/s]Running loglikelihood requests:  21%|██        | 770/3676 [00:04<00:09, 299.83it/s]Running loglikelihood requests:  24%|██▍       | 899/3676 [00:04<00:08, 343.30it/s]Running loglikelihood requests:  28%|██▊       | 1027/3676 [00:05<00:06, 385.67it/s]Running loglikelihood requests:  31%|███▏      | 1155/3676 [00:05<00:05, 425.64it/s]Running loglikelihood requests:  35%|███▍      | 1283/3676 [00:05<00:05, 463.40it/s]Running loglikelihood requests:  38%|███▊      | 1411/3676 [00:05<00:04, 469.44it/s]Running loglikelihood requests:  42%|████▏     | 1541/3676 [00:06<00:04, 506.29it/s]Running loglikelihood requests:  45%|████▌     | 1669/3676 [00:06<00:03, 545.06it/s]Running loglikelihood requests:  49%|████▉     | 1797/3676 [00:06<00:03, 575.71it/s]Running loglikelihood requests:  52%|█████▏    | 1926/3676 [00:06<00:02, 614.20it/s]Running loglikelihood requests:  56%|█████▌    | 2055/3676 [00:06<00:02, 648.87it/s]Running loglikelihood requests:  59%|█████▉    | 2183/3676 [00:07<00:02, 674.77it/s]Running loglikelihood requests:  63%|██████▎   | 2311/3676 [00:07<00:01, 712.92it/s]Running loglikelihood requests:  66%|██████▋   | 2440/3676 [00:07<00:01, 751.24it/s]Running loglikelihood requests:  70%|██████▉   | 2572/3676 [00:07<00:01, 793.52it/s]Running loglikelihood requests:  73%|███████▎  | 2701/3676 [00:07<00:01, 811.07it/s]Running loglikelihood requests:  77%|███████▋  | 2831/3676 [00:07<00:01, 839.93it/s]Running loglikelihood requests:  81%|████████  | 2962/3676 [00:07<00:00, 898.25it/s]Running loglikelihood requests:  84%|████████▍ | 3090/3676 [00:07<00:00, 944.46it/s]Running loglikelihood requests:  88%|████████▊ | 3218/3676 [00:08<00:00, 985.27it/s]Running loglikelihood requests:  91%|█████████ | 3348/3676 [00:08<00:00, 1054.59it/s]Running loglikelihood requests:  98%|█████████▊| 3597/3676 [00:08<00:00, 1426.25it/s]Running loglikelihood requests: 100%|██████████| 3676/3676 [00:08<00:00, 439.09it/s] 
INFO:lm_eval.loggers.evaluation_tracker:Saving results aggregated
INFO:lm_eval.loggers.evaluation_tracker:Saving per-sample results for: piqa
hf (pretrained=google/gemma-3-4b-it), gen_kwargs: (None), limit: None, num_fewshot: 0, batch_size: 128
|Tasks|Version|Filter|n-shot| Metric |   |Value |   |Stderr|
|-----|------:|------|-----:|--------|---|-----:|---|-----:|
|piqa |      1|none  |     0|acc     |↑  |0.7655|±  |0.0099|
|     |       |none  |     0|acc_norm|↑  |0.7737|±  |0.0098|

